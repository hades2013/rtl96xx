/*
 * Copyright (C) 2012 Realtek Semiconductor Corp. 
 * All Rights Reserved.
 *
 * This program is the proprietary software of Realtek Semiconductor
 * Corporation and/or its licensors, and only be used, duplicated, 
 * modified or distributed under the authorized license from Realtek. 
 *
 * ANY USE OF THE SOFTWARE OTHER THAN AS AUTHORIZED UNDER 
 * THIS LICENSE OR COPYRIGHT LAW IS PROHIBITED. 
 *
 */


#include "app_basic.h"
#include "omci_defs.h"

MIB_TABLE_INFO_T gMibSWImageTableInfo;
MIB_ATTR_INFO_T  gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ATTR_NUM];
MIB_TABLE_SWIMAGE_T gMibSWImageDefRow;
MIB_TABLE_OPER_T gMibSWImageOper;


GOS_ERROR_CODE SWImageDumpMib(void* pData)
{
	MIB_TABLE_SWIMAGE_T *pSwImage = (MIB_TABLE_SWIMAGE_T*)pData;
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"%s","SWImage");
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"EntityID: 0x%02x",pSwImage->EntityID);
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"Active: %d",pSwImage->Active);
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"Committed: %d",pSwImage->Committed);
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"Valid: %d",pSwImage->Valid);
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"Version: %s",pSwImage->Version);
	
	return GOS_OK;
}

GOS_ERROR_CODE SWImageDrvCfg(void* pOldRow,void* pNewRow,MIB_OPERA_TYPE  operationType)
{
	OMCI_LOG(OMCI_LOG_LEVEL_LOW,"%s: process end\n",__FUNCTION__);
	return GOS_OK;
}


GOS_ERROR_CODE SWImage_Init(void)
{
    gMibSWImageTableInfo.Name = "SWImage";
    gMibSWImageTableInfo.Desc = "Software Image";
    gMibSWImageTableInfo.MaxEntry = (UINT32)(2);
    gMibSWImageTableInfo.ClassId = (UINT32)(7);
    gMibSWImageTableInfo.InitType = (UINT32)(PON_ME_INIT_TYPE_AUTO);
    gMibSWImageTableInfo.StdType = (UINT32)(PON_ME_STD_TYPE_STD);
    gMibSWImageTableInfo.ActionType = (UINT32)(PON_ME_ACTION_GET | PON_ME_ACTION_ACT_SW | PON_ME_ACTION_COMMIT_SW);
    gMibSWImageTableInfo.pAttributes = &(gMibSWImageAttrInfo[0]);
	gMibSWImageTableInfo.attrNum = MIB_TABLE_SWIMAGE_ATTR_NUM;
	gMibSWImageTableInfo.entrySize = sizeof(MIB_TABLE_SWIMAGE_T);
	gMibSWImageTableInfo.pDefaultRow = &gMibSWImageDefRow;


    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].Name = "EntityID";
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].Name = "Version";
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].Name = "Committed";
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].Name = "Active";
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].Name = "Valid";

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Entity ID";
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Version";
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Is committed";
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Is active";
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Is valid";

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_UINT16;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_STR;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_UINT8;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_UINT8;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_UINT8;

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].Len = 2;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].Len = 14;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].Len = 1;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].Len = 1;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].Len = 1;

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = TRUE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = FALSE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = FALSE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = FALSE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = FALSE;

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_READ_ONLY;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_READ_ONLY;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_READ_ONLY;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_READ_ONLY;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_READ_ONLY;

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_HEX;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_CHAR;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_DEC;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_DEC;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_DEC;

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;

    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VERSION_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_COMMITTED_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_ACTIVE_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;
    gMibSWImageAttrInfo[MIB_TABLE_SWIMAGE_VALID_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;


    memset(&(gMibSWImageDefRow.EntityID), 0x00, sizeof(gMibSWImageDefRow.EntityID));
    memset(gMibSWImageDefRow.Version, '\0', MIB_TABLE_SWIMAGE_VERSION_LEN + 1);
    memset(&(gMibSWImageDefRow.Committed), 0x00, sizeof(gMibSWImageDefRow.Committed));
    memset(&(gMibSWImageDefRow.Active), 0x00, sizeof(gMibSWImageDefRow.Active));
    memset(&(gMibSWImageDefRow.Valid), 0x00, sizeof(gMibSWImageDefRow.Valid));


	gMibSWImageOper.meOperDrvCfg = SWImageDrvCfg;
	gMibSWImageOper.meOperConnCheck = NULL;
	gMibSWImageOper.meOperDump = SWImageDumpMib;
	gMibSWImageOper.meOperConnCfg = NULL;

	MIB_Register(MIB_TABLE_SWIMAGE_INDEX,&gMibSWImageTableInfo,&gMibSWImageOper);

    return GOS_OK;
}



