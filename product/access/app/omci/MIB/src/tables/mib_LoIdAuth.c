/*
 * Copyright (C) 2012 Realtek Semiconductor Corp. 
 * All Rights Reserved.
 *
 * This program is the proprietary software of Realtek Semiconductor
 * Corporation and/or its licensors, and only be used, duplicated, 
 * modified or distributed under the authorized license from Realtek. 
 *
 * ANY USE OF THE SOFTWARE OTHER THAN AS AUTHORIZED UNDER 
 * THIS LICENSE OR COPYRIGHT LAW IS PROHIBITED. 
 *
 */


#include "app_basic.h"
#include "omci_defs.h"

MIB_TABLE_INFO_T gMibLoIdAuthTableInfo;
MIB_ATTR_INFO_T  gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ATTR_NUM];
MIB_TABLE_LOIDAUTH_T gMibLoIdAuthDefRow;
MIB_TABLE_OPER_T gMibLoIdAuthOper;


GOS_ERROR_CODE LoIdAuthDumpMib(void *pData)
{
	MIB_TABLE_LOIDAUTH_T *pLoIdAuth = (MIB_TABLE_LOIDAUTH_T*)pData;
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"%s", "LoIdAuth");

	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"EntityId: 0x%02x", pLoIdAuth->EntityId);
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"OperationId: %s", pLoIdAuth->OperationId);
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"LoID: 0x%02x", pLoIdAuth->LoID);
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"Password: 0x%02x", pLoIdAuth->Password);
	OMCI_LOG(OMCI_LOG_LEVEL_HIGH,"AuthStatus: %d", pLoIdAuth->AuthStatus);

	return GOS_OK;
}

GOS_ERROR_CODE LoIdAuthDrvCfg(MIB_TABLE_INDEX tableIdx, void* pOldRow, void* pNewRow, MIB_OPERA_TYPE operationType)
{
	OMCI_LOG(OMCI_LOG_LEVEL_LOW,"%s: process end\n", __FUNCTION__);
	return GOS_OK;
}

GOS_ERROR_CODE LoIdAuth_Init(void)
{
    gMibLoIdAuthTableInfo.Name = "LoIdAuth";
    gMibLoIdAuthTableInfo.Desc = "LOID authentication";
    gMibLoIdAuthTableInfo.MaxEntry = (UINT32)(1);
    gMibLoIdAuthTableInfo.ClassId = (UINT32)(65530);
    gMibLoIdAuthTableInfo.InitType = (UINT32)(PON_ME_INIT_TYPE_AUTO);
    gMibLoIdAuthTableInfo.StdType = (UINT32)(PON_ME_STD_TYPE_PRO);
    gMibLoIdAuthTableInfo.ActionType = (UINT32)(PON_ME_ACTION_SET | PON_ME_ACTION_GET);
    gMibLoIdAuthTableInfo.pAttributes = &(gMibLoIdAuthAttrInfo[0]);

	gMibLoIdAuthTableInfo.attrNum = MIB_TABLE_LOIDAUTH_ATTR_NUM;
	gMibLoIdAuthTableInfo.entrySize = sizeof(MIB_TABLE_LOIDAUTH_T);
	gMibLoIdAuthTableInfo.pDefaultRow = &gMibLoIdAuthDefRow;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].Name = "EntityId";
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].Name = "OperationId";
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].Name = "LoID";
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].Name = "Password";
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].Name = "AuthStatus";

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Entity ID";
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Operator ID";
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "LOID";
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Password for ONU authentication";
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].Desc = "Authentication status";

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_UINT16;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_STR;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_STR;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_STR;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].DataType = MIB_ATTR_TYPE_UINT8;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].Len = 2;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].Len = 4;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].Len = 24;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].Len = 24;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].Len = 1;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = TRUE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = FALSE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = FALSE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = FALSE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].IsIndex = FALSE;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_READ_ONLY;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_WRITE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_WRITE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_WRITE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].UsrAcc = MIB_ATTR_USR_WRITE;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].MibSave = TRUE;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_HEX;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_CHAR;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_HEX;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_HEX;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].OutStyle = MIB_ATTR_OUT_DEC;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].OltAcc = PON_ME_OLT_READ | PON_ME_OLT_WRITE;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].AvcFlag = FALSE;

    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_ENTITYID_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_OPERATIONID_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_LOID_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_PASSWORD_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;
    gMibLoIdAuthAttrInfo[MIB_TABLE_LOIDAUTH_AUTHSTATUS_INDEX - MIB_TABLE_FIRST_INDEX].OptionType = PON_ME_ATTR_MANDATORY;

    memset(&(gMibLoIdAuthDefRow.EntityId), 0x00, sizeof(gMibLoIdAuthDefRow.EntityId));
    strncpy(&(gMibLoIdAuthDefRow.OperationId), "0", sizeof(gMibLoIdAuthDefRow.OperationId));
    strncpy(&(gMibLoIdAuthDefRow.LoID), "0", sizeof(gMibLoIdAuthDefRow.LoID));
    strncpy(&(gMibLoIdAuthDefRow.Password), "0", sizeof(gMibLoIdAuthDefRow.Password));
    memset(&(gMibLoIdAuthDefRow.AuthStatus), 0x00, sizeof(gMibLoIdAuthDefRow.AuthStatus));

    gMibLoIdAuthOper.meOperDrvCfg = LoIdAuthDrvCfg;
    gMibLoIdAuthOper.meOperConnCheck = NULL;
    gMibLoIdAuthOper.meOperDump = LoIdAuthDumpMib;
	gMibLoIdAuthOper.meOperConnCfg = NULL;

    MIB_Register(MIB_TABLE_LOIDAUTH_INDEX, &gMibLoIdAuthTableInfo, &gMibLoIdAuthOper);

    return GOS_OK;
}

